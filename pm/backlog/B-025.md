# B-025: ECMLink Data Integration

| Field        | Value                  |
|--------------|------------------------|
| Priority     | Medium                 |
| Status       | Pending                |
| Category     | feature                |
| Size         | L                      |
| Related PRD  | None                   |
| Dependencies | B-014 (Pi Testing)     |
| Created      | 2026-01-31             |

## Description

Integrate the Eclipse OBD-II monitoring system with the ECMLink V3 tuning workflow. The project's ultimate purpose is to **gather and analyze OBD-II data to inform ECU tuning decisions** made via ECMLink.

ECMLink V3 (from [ECMTuning](https://www.ecmtuning.com/)) is a programmable ECU tuning tool for the 1998 Eclipse GST (2G DSM, 4G63 turbo). It provides direct access to fuel maps, timing maps, airflow tables, and boost control. It logs at 1000+ samples/sec and supports Excel-compatible data import/export.

### Integration Points

1. **Data Export for ECMLink**: Export collected OBD-II data in a format that ECMLink's PC application can consume (Excel-compatible CSV with parameter columns matching ECMLink's log format)
2. **AI Tuning Recommendations**: Train the AI analysis to provide actionable recommendations in ECMLink terms:
   - "Fuel map cell at 2500 RPM / 1.2 load is running lean (14.9:1 AFR, target 12.5:1) -- suggest adding 3% fuel"
   - "Timing advance at 3000 RPM / 1.5 load shows knock retard patterns -- suggest pulling 2 degrees"
3. **Before/After Comparison**: Compare drive data before and after a tuning change to quantify the impact
4. **Tuning Session Tracking**: Log when tuning changes were made (date, parameter, old value, new value) and link subsequent drives to that session
5. **ECMLink Parameter Mapping**: Map standard OBD-II PIDs to ECMLink's parameter names for consistent reporting

### ECMLink Key Parameters

| ECMLink Parameter | OBD-II Equivalent | Tuning Relevance |
|-------------------|-------------------|------------------|
| wbfactor | Wideband O2 | Fuel map correction factor |
| airflowperrev | MAF + RPM | Volumetric efficiency |
| load | Calculated load | Fuel/timing map Y-axis |
| RPM | Engine RPM | Fuel/timing map X-axis |
| Timing Advance | Spark advance | Timing map output |
| Boost | MAP sensor | Turbo tune target |
| IAT | Intake air temp | Density correction |
| Coolant Temp | Engine coolant | Warmup enrichment |

## Acceptance Criteria

- [ ] Data export format compatible with ECMLink's Excel import
- [ ] AI recommendations reference specific fuel map / timing map cells
- [ ] Before/after drive comparison shows parameter changes
- [ ] Tuning session log tracks changes over time
- [ ] Documentation: how to use Eclipse OBD-II data with ECMLink

## Notes

- **Not yet installable**: The programmable ECU is not in the vehicle yet. This backlog item is future work.
- **Phase**: This belongs in a future phase after Pi deployment is complete and the car has been tested with the stock ECU.
- The current system already monitors the key parameters (AFR, RPM, load, temps, boost). The integration work is about formatting output and tuning the AI prompts to speak ECMLink's language.
- ECMLink logs at 1000+ samples/sec vs OBD-II's ~10 samples/sec. Our system provides long-term trending data, not real-time high-speed tuning. The two tools are complementary: ECMLink for live tuning, Eclipse OBD-II for long-term analysis.
- ECMLink supports Excel copy-paste for data import/export. Our CSV export module could format data to match.
